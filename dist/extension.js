var ke=Object.create;var q=Object.defineProperty;var be=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var Ce=Object.getPrototypeOf,ve=Object.prototype.hasOwnProperty;var xe=(e,r)=>{for(var t in r)q(e,t,{get:r[t],enumerable:!0})},U=(e,r,t,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of ge(r))!ve.call(e,o)&&o!==t&&q(e,o,{get:()=>r[o],enumerable:!(s=be(r,o))||s.enumerable});return e};var w=(e,r,t)=>(t=e!=null?ke(Ce(e)):{},U(r||!e||!e.__esModule?q(t,"default",{value:e,enumerable:!0}):t,e)),_e=e=>U(q({},"__esModule",{value:!0}),e);var De={};xe(De,{activate:()=>Ge,deactivate:()=>Ne});module.exports=_e(De);var H=w(require("vscode"),1);var Q=w(require("vscode"),1);function J(e){let r=(t,...s)=>{let{escapeSpecialCharacters:o=!1}=e,i=[...t].reduce((n,c,d)=>n+c+(s[d]||""),"").split(`
`).filter(n=>n.trim()!==""),f=Math.min(...i.map(n=>n.match(/^\s*/)[0].length));return i.map(n=>(n=n.substring(f),o?n.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{"):n)).join(`
`)};return r.withOptions=t=>J({...e,...t}),r}var we=J({}),S=we;function T(e){return e.charAt(0).toUpperCase()+e.slice(1)}function B(e){if(!e.theme){let o=["light","dark","dark","light"];e.theme=o[Q.window.activeColorTheme.kind]}let{name:r,theme:t,icon:s}=e;return S`
    <div class="github-alert ga-${r}" theme="${t}">
      <span class="ga-title">
        <svg xmlns="http://www.w3.org/2000/svg" class="ga-${s.name}" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
          <path d="${s.path}"/>
        </svg>
        ${T(r)}
      </span>
      <span class="ga-content">
  `}function P(){return S`
      </span>
    </div>
  `}function Me(e){return e===9||e===32}function I(e,r,t,s){let o=e.bMarks[r]+e.tShift[r],i=e.eMarks[r],f=e.lineMax;if(e.sCount[r]-e.blkIndent>=4||e.src.charCodeAt(o)!==62)return!1;if(s)return!0;let n=[],c=[],d=[],u=[],p=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let a=!1,l;for(l=r;l<t;l++){let b=e.sCount[l]<e.blkIndent;if(o=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],o>=i)break;if(e.src.charCodeAt(o++)===62&&!b){let k=e.sCount[l]+1,g,x;e.src.charCodeAt(o)===32?(o++,k++,x=!1,g=!0):e.src.charCodeAt(o)===9?(g=!0,(e.bsCount[l]+k)%4===3?(o++,k++,x=!1):x=!0):g=!1;let y=k;for(n.push(e.bMarks[l]),e.bMarks[l]=o;o<i;){let A=e.src.charCodeAt(o);if(Me(A))A===9?y+=4-(y+e.bsCount[l]+(x?1:0))%4:y++;else break;o++}a=o>=i,c.push(e.bsCount[l]),e.bsCount[l]=e.sCount[l]+1+(g?1:0),d.push(e.sCount[l]),e.sCount[l]=y-k,u.push(e.tShift[l]),e.tShift[l]=o-e.bMarks[l];continue}if(a)break;let C=!1;for(let k=0,g=p.length;k<g;k++)if(p[k](e,l,t,!0)){C=!0;break}if(C){e.lineMax=l,e.blkIndent!==0&&(n.push(e.bMarks[l]),c.push(e.bsCount[l]),u.push(e.tShift[l]),d.push(e.sCount[l]),e.sCount[l]-=e.blkIndent);break}n.push(e.bMarks[l]),c.push(e.bsCount[l]),u.push(e.tShift[l]),d.push(e.sCount[l]),e.sCount[l]=-1}let m=e.blkIndent;e.blkIndent=0;let v=e.push("blockquote_open","blockquote",1);v.markup=">",v.map=[r,0],e.md.block.tokenize(e,r,l);let _=e.push("blockquote_close","blockquote",-1);_.markup=">",e.lineMax=f,e.parentType=h,v.map=[r,e.line];for(let b=0;b<u.length;b++)e.bMarks[b+r]=n[b],e.tShift[b+r]=u[b],e.sCount[b+r]=d[b],e.bsCount[b+r]=c[b];return e.blkIndent=m,!0}var Ae=w(require("vscode"),1),X=[{name:"note",icon:{name:"info",path:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"}},{name:"tip",icon:{name:"light-bulb",path:"M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"}},{name:"important",icon:{name:"report",path:"M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"}},{name:"warning",icon:{name:"alert",path:"M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"}},{name:"caution",icon:{name:"stop",path:"M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"}}];var Y=w(require("vscode"),1);function R(e){if(!e.theme){let f=["light","dark","dark","light"];e.theme=f[Y.window.activeColorTheme.kind]}let{name:r,theme:t,icon:s,isCollapsible:o,initialState:i}=e;return S`
    <div class="obsidian-callout oc-${r} ${o?"is-collapsible":""}" theme="${t}">
      <${o?"label":"div"} class="oc-heading">
        <div class="oc-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="oc-${s.name}">
            ${s.components.map(f=>S`
                <${f.name} ${Object.entries(f.attrs).map(([n,c])=>`${n}="${c}"`).join(" ")} />
              `).join("")}
          </svg>
        </div>
        <div class="oc-title">${T(r)}</div>
        ${o?`<div class="oc-fold">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-chevron-down">
            <path d="m6 9 6 6 6-6"/>
          </svg>
        </div>`:""}
        ${o?'<input name="oc-state" type="checkbox" '+(i==="open"?"":"checked")+"/>":""}
      </${o?"label":"div"}>
      <div class="oc-content">
  `}function V(){return S`
      </div>
    </div>
  `}var Te=w(require("vscode"),1),L=[{aliases:["note","custom"],icon:{name:"lucide-pencil",components:[{name:"path",attrs:{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}},{name:"path",attrs:{d:"m15 5 4 4"}}]}},{aliases:["abstract","summary","tldr"],icon:{name:"lucide-clipboard-list",components:[{name:"rect",attrs:{x:8,y:2,width:8,height:4,rx:1,ry:1}},{name:"path",attrs:{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}},{name:"path",attrs:{d:"M12 11h4"}},{name:"path",attrs:{d:"M12 16h4"}},{name:"path",attrs:{d:"M8 11h.01"}},{name:"path",attrs:{d:"M8 16h.01"}}]}},{aliases:["info"],icon:{name:"lucide-info",components:[{name:"circle",attrs:{cx:12,cy:12,r:10}},{name:"path",attrs:{d:"M12 16v-4"}},{name:"path",attrs:{d:"M12 8h.01"}}]}},{aliases:["todo"],icon:{name:"lucide-check-circle-2",components:[{name:"circle",attrs:{cx:12,cy:12,r:10}},{name:"path",attrs:{d:"m9 12 2 2 4-4"}}]}},{aliases:["tip","hint","important"],icon:{name:"lucide-flame",components:[{name:"path",attrs:{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"}}]}},{aliases:["success","check","done"],icon:{name:"lucide-check",components:[{name:"path",attrs:{d:"M20 6 9 17l-5-5"}}]}},{aliases:["question","help","faq"],icon:{name:"lucide-help-circle",components:[{name:"circle",attrs:{cx:12,cy:12,r:10}},{name:"path",attrs:{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}},{name:"path",attrs:{d:"M12 17h.01"}}]}},{aliases:["warning","caution","attention"],icon:{name:"lucide-alert-triangle",components:[{name:"path",attrs:{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}},{name:"path",attrs:{d:"M12 9v4"}},{name:"path",attrs:{d:"M12 17h.01"}}]}},{aliases:["failure","fail","missing"],icon:{name:"lucide-x",components:[{name:"path",attrs:{d:"M18 6 6 18"}},{name:"path",attrs:{d:"m6 6 12 12"}}]}},{aliases:["danger","error"],icon:{name:"lucide-zap",components:[{name:"polygon",attrs:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}}]}},{aliases:["bug"],icon:{name:"lucide-bug",components:[{name:"path",attrs:{d:"m8 2 1.88 1.88"}},{name:"path",attrs:{d:"M14.12 3.88 16 2"}},{name:"path",attrs:{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"}},{name:"path",attrs:{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"}},{name:"path",attrs:{d:"M12 20v-9"}},{name:"path",attrs:{d:"M6.53 9C4.6 8.8 3 7.1 3 5"}},{name:"path",attrs:{d:"M6 13H2"}},{name:"path",attrs:{d:"M3 21c0-2.1 1.7-3.9 3.8-4"}},{name:"path",attrs:{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4"}},{name:"path",attrs:{d:"M22 13h-4"}},{name:"path",attrs:{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4"}}]}},{aliases:["example"],icon:{name:"lucide-list",components:[{name:"line",attrs:{x1:8,y1:6,x2:21,y2:6}},{name:"line",attrs:{x1:8,y1:12,x2:21,y2:12}},{name:"line",attrs:{x1:8,y1:18,x2:21,y2:18}},{name:"line",attrs:{x1:3,y1:6,x2:3.01,y2:6}},{name:"line",attrs:{x1:3,y1:12,x2:3.01,y2:12}},{name:"line",attrs:{x1:3,y1:18,x2:3.01,y2:18}}]}},{aliases:["quote","cite"],icon:{name:"lucide-quote",components:[{name:"path",attrs:{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"}},{name:"path",attrs:{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"}}]}}];var ee=w(require("vscode"),1);function ne(e){if(e===void 0||e?.type!=="inline")return;let r=e?.content?.split(`
`);if(!r||r.length<=1)return;let t=r[0].trim();if(!t.startsWith("[!"))return;let s=/^\[[!](note|abstract|summary|tldr|info|todo|tip|hint|important|success|check|done|question|help|faq|warning|caution|attention|failure|fail|missing|danger|error|bug|example|quote|cite)\]([+-])*$/,o=t.toLowerCase().match(s);return o?.[1]?{name:o[1],renderStyle:o[1].match(/(note|important|tip|warning|caution)/)?ee.workspace.getConfiguration("markdownPreviewPlus.styledBlockquote.renderStyle").get(o[1]):"Obsidian",isCollapsible:!!o?.[2],initialState:o?.[2]&&o[2]==="-"?"closed":"open"}:null}function oe(e,r,t,s,o){let i=e[r];if(i.meta){if(i.meta.obsidianCallout)return R(i.meta.obsidianCallout);if(i.meta.gitHubAlert)return B(i.meta.gitHubAlert)}return o.renderToken(e,r,t)}function re(e,r,t,s,o){let i=e[r];if(i.meta){if(i.meta.isObsidianCallout)return V();if(i.meta.isGitHubAlert)return P()}return o.renderToken(e,r,t)}function Z(e){e.renderer.rules.blockquote_open=oe,e.renderer.rules.blockquote_close=re,e.block.ruler.at("blockquote",(r,t,s,o)=>{let i=I(r,t,s,o);if(!i)return!1;let f=r.tokens,n=f[f.length-1];if(n?.type!=="blockquote_close")return i;let c;for(c=f.length-2;c>=0;c--){let a=f[c];if(a===null)throw new Error("Opening tag not found for blockquote!");if(a?.type==="blockquote_open")break}let d=f[c+2],u=ne(d);if(!u)return i;let p=u.renderStyle==="GitHub",h=u.renderStyle==="Obsidian";if(p){let a=X.find(l=>l.name===u.name);f[c].meta={isGitHubAlert:p,gitHubAlert:a},n.meta={isGitHubAlert:p}}if(h){let a=L.find(l=>l.aliases.includes(u.name));a.name=u.name,a.isCollapsible=u.isCollapsible,a.initialState=u.initialState,f[c].meta={isObsidianCallout:h,obsidianCallout:a},n.meta={isObsidianCallout:h}}return d.content=d.content.split(`
`).slice(1).join(`
`),i},{alt:["paragraph","reference","blockquote","list"]})}var te=w(require("vscode"),1);function Ie(e,r,t,s,o){let i=typeof s.docId=="string"?`-${s.docId}-`:"",f=Number(e[r].meta.id+1).toString();return i+f}function $e(e,r,t,s,o){let i=Number(e[r].meta.id+1).toString();return e[r].meta.subId>0&&(i+=`:${e[r].meta.subId}`),`[${i}]`}function qe(e,r,t,s,o){let i=o.rules.footnote_anchor_name(e,r,t,s,o),f=o.rules.footnote_caption(e,r,t,s,o),n=e[r].meta.subId>0?`${i}:${e[r].meta.subId}`:i;return`<sup class="footnote"><a class="fn-label" href="#fn-${i}" id="fnref-${n}">${f}</a></sup>`}function Oe(e,r,t){let s=`<section class="footnotes">
<ol class="fn-list">
`;return te.workspace.getConfiguration("markdownPreviewPlus.footnote").get("useHorizontalRule")?`<hr class="fn-divider"${t.xhtmlOut?" />":">"}
${s}`:s}function He(){return`</ol>
</section>
`}function Be(e,r,t,s,o){let i=o.rules.footnote_anchor_name(e,r,t,s,o);return e[r].meta.subId>0&&(i+=`:${e[r].meta.subId}`),`<li id="fn-${i}" class="fn-item">`}function Pe(){return`</li>
`}function Re(e,r,t,s,o){let i=o.rules.footnote_anchor_name(e,r,t,s,o);return e[r].meta.subId>0&&(i+=`:${e[r].meta.subId}`),` <a href="#fnref-${i}" class="fn-label">\u21A9\uFE0E</a>`}function E(e){let r=e.helpers.parseLinkLabel,t=e.utils.isSpace;e.renderer.rules.footnote_ref=qe,e.renderer.rules.footnote_block_open=Oe,e.renderer.rules.footnote_block_close=He,e.renderer.rules.footnote_open=Be,e.renderer.rules.footnote_close=Pe,e.renderer.rules.footnote_anchor=Re,e.renderer.rules.footnote_caption=$e,e.renderer.rules.footnote_anchor_name=Ie;function s(n,c,d,u){let p=n.bMarks[c]+n.tShift[c],h=n.eMarks[c];if(p+4>h||n.src.charCodeAt(p)!==91||n.src.charCodeAt(p+1)!==94)return!1;let a;for(a=p+2;a<h;a++){if(n.src.charCodeAt(a)===32)return!1;if(n.src.charCodeAt(a)===93)break}if(a===p+2||a+1>=h||n.src.charCodeAt(++a)!==58)return!1;if(u)return!0;a++,n.env.footnotes||(n.env.footnotes={}),n.env.footnotes.refs||(n.env.footnotes.refs={});let l=n.src.slice(p+2,a-2);n.env.footnotes.refs[`:${l}`]=-1;let m=new n.Token("footnote_reference_open","",1);m.meta={label:l},m.level=n.level++,n.tokens.push(m);let v=n.bMarks[c],_=n.tShift[c],b=n.sCount[c],C=n.parentType,k=a,g=n.sCount[c]+a-(n.bMarks[c]+n.tShift[c]),x=g;for(;a<h;){let A=n.src.charCodeAt(a);if(!t(A))break;x+=A===9?4-x%4:1,a++}n.tShift[c]=a-k,n.sCount[c]=x-g,n.bMarks[c]=k,n.blkIndent+=4,n.parentType="blockquote",n.sCount[c]<n.blkIndent&&(n.sCount[c]+=n.blkIndent),n.md.block.tokenize(n,c,d),n.parentType=C,n.blkIndent-=4,n.tShift[c]=_,n.sCount[c]=b,n.bMarks[c]=v;let y=new n.Token("footnote_reference_close","",-1);return y.level=--n.level,n.tokens.push(y),!0}function o(n,c){let d=n.posMax,u=n.pos;if(u+2>=d||n.src.charCodeAt(u)!==94||n.src.charCodeAt(u+1)!==91)return!1;let p=u+2,h=r(n,u+1);if(h<0)return!1;if(!c){n.env.footnotes||(n.env.footnotes={}),n.env.footnotes.list||(n.env.footnotes.list=[]);let a=n.env.footnotes.list.length,l=[];n.md.inline.parse(n.src.slice(p,h),n.md,n.env,l);let m=n.push("footnote_ref","",0);m.meta={id:a},n.env.footnotes.list[a]={content:n.src.slice(p,h),tokens:l}}return n.pos=h+1,n.posMax=d,!0}function i(n,c){let d=n.posMax,u=n.pos;if(u+3>d||!n.env.footnotes||!n.env.footnotes.refs||n.src.charCodeAt(u)!==91||n.src.charCodeAt(u+1)!==94)return!1;let p;for(p=u+2;p<d;p++){if(n.src.charCodeAt(p)===32||n.src.charCodeAt(p)===10)return!1;if(n.src.charCodeAt(p)===93)break}if(p===u+2||p>=d)return!1;p++;let h=n.src.slice(u+2,p-1);if(typeof n.env.footnotes.refs[`:${h}`]>"u")return!1;if(!c){n.env.footnotes.list||(n.env.footnotes.list=[]);let a;n.env.footnotes.refs[`:${h}`]<0?(a=n.env.footnotes.list.length,n.env.footnotes.list[a]={label:h,count:0},n.env.footnotes.refs[`:${h}`]=a):a=n.env.footnotes.refs[`:${h}`];let l=n.env.footnotes.list[a].count;n.env.footnotes.list[a].count++;let m=n.push("footnote_ref","",0);m.meta={id:a,subId:l,label:h}}return n.pos=p,n.posMax=d,!0}function f(n){let c,d,u,p=!1,h={};if(!n.env.footnotes||(n.tokens=n.tokens.filter(l=>l?.type==="footnote_reference_open"?(p=!0,d=[],u=l.meta.label,!1):l?.type==="footnote_reference_close"?(p=!1,h[":"+u]=d,!1):(p&&d.push(l),!p)),!n.env.footnotes.list))return;let a=n.env.footnotes.list;n.tokens.push(new n.Token("footnote_block_open","",1));for(let l=0,m=a.length;l<m;l++){let v=new n.Token("footnote_open","",1);if(v.meta={id:l,label:a[l].label},n.tokens.push(v),a[l].tokens){c=[];let C=new n.Token("paragraph_open","p",1);C.block=!0,c.push(C);let k=new n.Token("inline","",0);k.children=a[l].tokens,k.content=a[l].content,c.push(k);let g=new n.Token("paragraph_close","p",-1);g.block=!0,c.push(g)}else a[l].label&&(c=h[`:${a[l].label}`]);c&&(n.tokens=n.tokens.concat(c));let _=n.tokens[n.tokens.length-1]?.type==="paragraph_close"?n.tokens.pop():null,b=a[l].count>0?a[l].count:1;for(let C=0;C<b;C++){let k=new n.Token("footnote_anchor","",0);k.meta={id:l,subId:C,label:a[l].label},n.tokens.push(k)}_&&n.tokens.push(_),n.tokens.push(new n.Token("footnote_close","",-1))}n.tokens.push(new n.Token("footnote_block_close","",-1))}e.block.ruler.before("reference","footnote_def",s,{alt:["paragraph","reference"]}),e.inline.ruler.after("image","footnote_inline",o),e.inline.ruler.after("footnote_inline","footnote_ref",i),e.core.ruler.after("inline","footnote_tail",f)}var $=[],le=e=>({value:encodeURI(e.trim().toLowerCase().replace(/\s+/g,"-").replace(/[\]\[\!\/\'\"\#\$\%\&\(\)\*\+\,\.\/\:\;\<\=\>\?\@\\\^\{\|\}\~\`。，、；：？！…—·ˉ¨‘’“”々～‖∶＂＇｀｜〃〔〕〈〉《》「」『』．〖〗【】（）［］｛｝]/g,"").replace(/^\-+/,"").replace(/\-+$/,""))}),O=new Map;function Ve(e,r,t,s){let o=e.tokens;return $.length&&($=[]),o.forEach(i=>{if(i?.type==="heading_open"){if($.find(n=>n.token===i))return!1;let f=o[o.indexOf(i)+1].content;$.push({token:i,content:f})}}),!1}function Ze(e,r){if(e.src.charCodeAt(e.pos)!==91||r||!/^\[\[toc\]\]/im.test(e.src.slice(e.pos)))return!1;let s=e.push("toc_open","toc",1);s.markup="[[toc]]",s=e.push("toc_body","",0),s=e.push("toc_close","toc",-1);let o=e.src.indexOf(`
`,e.pos);return e.pos=o!==-1?o:e.pos+e.posMax+1,!0}function F(e){e.renderer.rules.toc_open=(r,t)=>'<div class="table-of-contents">',e.renderer.rules.toc_body=(r,t,s,o,i)=>{let f=[],n=[];for($.forEach(c=>{let d=parseInt(c.token.tag.replace(/h/ig,"")),u=c.content,p=le(u);if(O.has(p.value)){let l=O.get(p.value)+1;O.set(p.value,l),p=le(p.value+"-"+l)}else O.set(p.value,0);let h=`<li><a href="#${p.value}">${u}</a></li>`;for(;n.length>d;)f.push("</ul>"),n.pop();n.length===d||(f.push("<ul>"),n.push("<ul>")),f.push(h)});n.length;)f.push("</ul>"),n.pop();return f.join("")},e.renderer.rules.toc_close=(r,t)=>"</div>",e.block.ruler.after("heading","capture_headings",Ve),e.inline.ruler.push("toc",Ze)}var ie=w(require("vscode"),1);function Ee(e){return/^#[0-9A-F]{3}([0-9A-F]{3})?$/i.test(e)}function Fe(e){return/^rgb\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)$/i.test(e)}function je(e){return/^hsl\(\s*\d{1,3}(deg)?\s*,\s*\d{1,3}%\s*,\s*\d{1,3}%\s*\)$/i.test(e)}function j(e){let r=e.renderer.rules.code_inline||((t,s,o,i,f)=>f.renderToken(t,s,o));e.renderer.rules.code_inline=(t,s,o,i,f)=>{let c=t[s]?.content;return(Ee(c)||Fe(c)||je(c)?c:null)?`<code class="color-tag" theme="${["light","dark","dark","light"][ie.window.activeColorTheme.kind]}">${c}<span style="background-color: ${c};" class="color-swatch"></span></code>`:r(t,s,o,i,f)}}var z=w(require("vscode"),1);function G(e){let r=e.renderer.rules.mark_open||function(t,s,o,i,f){return f.renderToken(t,s,o)};e.renderer.rules.mark_open=function(t,s,o,i,f){let n=z.workspace.getConfiguration("markdownPreviewPlus.highlighter").get("styleVariant");return n!=="none"&&t[s].attrPush(["class",`highlighter ${n}`]),r(t,s,o,i,f)},e.inline.ruler.before("emphasis","mark",(t,s)=>{if(s)return!1;let o=z.workspace.getConfiguration("markdownPreviewPlus.highlighter").get("syntaxVariant");if(o==="<mark>")return!1;let i=o==="#"?"#":"==",f=o==="#"?35:61,n=t.pos;if(t.src.charCodeAt(n)!==f)return!1;let d=t.pos+1;for(;d<t.src.length&&t.src.charCodeAt(d)!==f;)d++;if(d>=t.src.length||d<=n+2||t.src.charCodeAt(d)!==f||n>0&&t.src.charCodeAt(n-1)!==32&&t.src.charCodeAt(n-1)!==10||d+1<t.src.length&&t.src.charCodeAt(d+1)!==32&&t.src.charCodeAt(d+1)!==10)return!1;t.pos=n;let u=t.push("mark_open","mark",1);return u.markup=i,u.level=t.level,t.pos=n+1,u=t.push("text","",0),u.content=t.src.slice(n+1,d),u.level=t.level,t.pos=d,u=t.push("mark_close","mark",-1),u.markup=i,u.level=t.level,t.pos=d+1,!0})}var ue=w(require("vscode"),1);function ae(e){return e===9||e===32}function se(e,r){let t=e.bMarks[r]+e.tShift[r],s=e.eMarks[r],o=e.src.charCodeAt(t++);return o!==42&&o!==45&&o!==43||t<s&&!ae(e.src.charCodeAt(t))?-1:t}function ce(e,r){let t=e.bMarks[r]+e.tShift[r],s=e.eMarks[r],o=t;if(o+1>=s)return-1;let i=e.src.charCodeAt(o++);if(i<48||i>57)return-1;for(;;){if(o>=s)return-1;if(i=e.src.charCodeAt(o++),i>=48&&i<=57){if(o-t>=10)return-1;continue}if(i===41||i===46)break;return-1}return o<s&&!ae(e.src.charCodeAt(o))?-1:o}function ze(e,r){let t=e.level+2;for(let s=r+2,o=e.tokens.length-2;s<o;s++)e.tokens[s].level===t&&e.tokens?.[s]?.type==="paragraph_open"&&(e.tokens[s+2].hidden=!0,e.tokens[s].hidden=!0,s+=2)}function N(e,r,t,s){let o,i,f,n=r,c=!0;if(e.sCount[n]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[n]-e.listIndent>=4&&e.sCount[n]<e.blkIndent)return!1;let d=!!(s&&e.parentType==="paragraph"&&e.sCount[n]>=e.blkIndent),u,p,h;if((h=ce(e,n))>=0){if(u=!0,f=e.bMarks[n]+e.tShift[n],p=Number(e.src.slice(f,h-1)),d&&p!==1)return!1}else if((h=se(e,n))>=0)u=!1;else return!1;if(d&&e.skipSpaces(h)>=e.eMarks[n])return!1;if(s)return!0;let a=e.src.charCodeAt(h-1),l=e.tokens.length,m;u?(m=e.push("ordered_list_open","ol",1),p!==1&&(m.attrs=[["start",String(p)]])):m=e.push("bullet_list_open","ul",1);let v=[n,0];m.map=v,m.markup=String.fromCharCode(a);let _=!1,b=e.md.block.ruler.getRules("list"),C=e.parentType;for(e.parentType="list";n<t;){i=h,o=e.eMarks[n];let k=e.sCount[n]+h-(e.bMarks[n]+e.tShift[n]),g=k;for(;i<o;){let M=e.src.charCodeAt(i);if(M!==9&&M!==32)break;M===9?g+=4-(g+e.bsCount[n])%4:M===32&&g++,i++}let x=i,y=x>=o||g-k>4?1:g-k,A=k+y;m=e.push("list_item_open","li",1),m.markup=String.fromCharCode(a);let K=[n,0];m.map=K,u&&(m.info=e.src.slice(f,h-1));let fe=e.tight,pe=e.tShift[n],de=e.sCount[n],he=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=A,e.tight=!0,e.tShift[n]=x-e.bMarks[n],e.sCount[n]=g,x>=o&&e.isEmpty(n+1)?e.line=Math.min(e.line+2,t):e.md.block.tokenize(e,n,t),(!e.tight||_)&&(c=!1),_=e.line-n>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=he,e.tShift[n]=pe,e.sCount[n]=de,e.tight=fe,m=e.push("list_item_close","li",-1),m.markup=String.fromCharCode(a),n=e.line,K[1]=n,n>=t||e.sCount[n]<e.blkIndent||e.sCount[n]-e.blkIndent>=4)break;let W=!1;for(let M=0,me=b.length;M<me;M++)if(b[M](e,n,t,!0)){W=!0;break}if(W)break;if(u){if(h=ce(e,n),h<0)break;f=e.bMarks[n]+e.tShift[n]}else if(h=se(e,n),h<0)break;if(a!==e.src.charCodeAt(h-1))break}return u?m=e.push("ordered_list_close","ol",-1):m=e.push("bullet_list_close","ul",-1),m.markup=String.fromCharCode(a),v[1]=n,e.line=n,e.parentType=C,c&&ze(e,l),!0}function D(e){e.renderer.rules.task_list_open=function(r,t,s,o,i){return'<ul class="task-list">'},e.renderer.rules.task_list_item_open=function(r,t,s,o,i){let f=r[t].meta.checkboxValue,n=f.charCodeAt(0)!==32,c=f==="x";return`<li class="tl-item">${`<label class="tl-marker${ue.workspace.getConfiguration("markdownPreviewPlus.taskList").get("staticCheckboxes")?" is-static":""}"><input type="checkbox" class="tl-checkbox" ${n?"checked":""}></label>`}<span class="tl-content${c?" is-strikethrough":""}">`},e.renderer.rules.task_list_item_close=function(r,t,s,o,i){return"</span></li>"},e.renderer.rules.task_list_close=function(r,t,s,o,i){return"</ul>"},e.block.ruler.at("list",(r,t,s,o)=>{let i=N(r,t,s,o);if(!i)return!1;let f=r.tokens;if(f.at(-1)?.type!=="bullet_list_close")return i;let n=f.findLastIndex(l=>l?.type==="bullet_list_open"),c=f[n],d=f.slice(n+1),u=d.filter(l=>l?.type==="list_item_open"),p=d.filter(l=>l?.type==="inline"),h=d.filter(l=>l?.type==="list_item_close"),a=f.at(-1);for(let l=0;l<u.length;l++){let m=p[l]?.content?.match(/^\[(.)\]\s(.*)$/);if(!m)continue;let[v,_,b]=m;u[l].type="task_list_item_open",u[l].meta??={},u[l].meta.checkboxValue=_,p[l].content=b,h[l].type="task_list_item_close"}return u.some(l=>l?.type==="task_list_item_open")&&(c.type="task_list_open",a.type="task_list_close"),i},{alt:["paragraph","reference","blockquote"]})}function Ge(e){return e.subscriptions.push(H.workspace.onDidChangeConfiguration(r=>{r.affectsConfiguration("markdownPreviewPlus")&&H.commands.executeCommand("markdown.preview.refresh")})),{extendMarkdownIt(r){return r.use(Z).use(E).use(F).use(j).use(G).use(D)}}}function Ne(){}0&&(module.exports={activate,deactivate});
